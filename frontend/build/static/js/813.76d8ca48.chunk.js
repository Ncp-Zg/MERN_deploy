"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[813],{4813:function(e,n,t){t.r(n);var r=t(5861),s=t(885),i=t(7757),o=t.n(i),c=t(7621),u=t(6151),a=t(4569),l=t.n(a),d=t(2791),f=t(6030),p=t(6871),h=t(7111),m=t.n(h),x=t(6960),y=t(2864),v=t(7343),j=t(5764),C=t(2482),Z=t.n(C),T=t(184);n.default=function(){var e=(0,j.useStripe)(),n=(0,j.useElements)(),t=(0,d.useState)(!1),i=(0,s.Z)(t,2),a=(i[0],i[1]),h=(0,d.useState)(null),C=(0,s.Z)(h,2),g=C[0],w=C[1],k=(0,d.useState)(!0),E=(0,s.Z)(k,2),S=(E[0],E[1],(0,d.useState)(!1)),M=(0,s.Z)(S,2),A=M[0],_=M[1],b=(0,d.useState)(""),R=(0,s.Z)(b,2),D=R[0],I=(R[1],(0,p.TH)().state),O=(0,p.s0)(),P=(0,f.I0)(),K=(0,f.v9)((function(e){return{cart:e.cart.cart,user:e.auth}})),N=K.cart,B=K.user,F=(0,d.useRef)();(0,d.useEffect)((function(){F.current=(0,y.io)("https://web-shop-socketio.herokuapp.com/")}),[]);var H=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==N[0]._id){e.next=5;break}x.Am.error("Your cart is empty"),O("/home"),e.next=12;break;case 5:return _(!0),e.next=8,l().post("/api/orders/addorders",N,{withCredentials:!0}).then((function(e){x.Am.success("Payment is successfull")})).catch((function(e){console.log(e),x.Am.error("".concat(e.response.data.message))}));case 8:_(!1),N.forEach((function(e){setTimeout((function(){F.current&&""!==B.user.id&&(null===F||void 0===F||F.current.emit("addUser",e.seller))}),500)})),P((0,v.vs)()),O("/home");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var t=(0,r.Z)(o().mark((function t(s){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(!0),s.preventDefault(),t.next=4,e.confirmCardPayment(D,{payment_method:{card:n.getElement(j.CardElement)}}).then(function(){var e=(0,r.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.error){e.next=5;break}x.Am.error(n.error.message),a(!1),e.next=14;break;case 5:return _(!0),e.next=8,l().post("/api/orders/addorders",N,{withCredentials:!0}).then((function(e){x.Am.success("Payment is successfull")})).catch((function(e){console.log(e),x.Am.error("".concat(e.response.data.message))}));case 8:a(!1),w(null),_(!1),N.forEach((function(e){setTimeout((function(){F.current&&""!==e.seller&&(null===F||void 0===F||F.current.emit("addUser",e.seller))}),500)})),P((0,v.vs)()),O("/home");case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,T.jsx)("div",{children:A?(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,T.jsx)(m(),{size:30,color:"#c67c03"})}):(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,T.jsx)(c.Z,{style:{height:"50vh",width:"80vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:(0,T.jsxs)("form",{onSubmit:U,style:{marginTop:"20px"},children:[(0,T.jsx)("p",{children:"StripeJS here!!"}),g&&(0,T.jsx)("div",{children:g})]})})})}),(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"5px"},children:(0,T.jsxs)(c.Z,{style:{height:"15vh",width:"80vh",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px"},children:[(0,T.jsx)(Z(),{renderText:function(e){return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)("h3",{children:["Order Total:"," ",(0,T.jsx)("strong",{children:e})]})})},decimalScale:2,value:I,displayType:"text",thousandSeparator:!0,prefix:"\u20ba"}),(0,T.jsx)(u.Z,{onClick:H,children:"Buy"})]})})]})})}},7343:function(e,n,t){t.d(n,{Xq:function(){return s},kx:function(){return i},dm:function(){return o},yy:function(){return c},vs:function(){return u}});var r=t(6562),s=function(e){return function(n){n({type:r.M.ADD_TO_CART,payload:e})}},i=function(e){return function(n){n({type:r.M.DELETE_ITEM_FROM_CART,payload:e})}},o=function(e){return function(n){n({type:r.M.ADD_ITEM_TO_CART,payload:e})}},c=function(e){return function(n){n({type:r.M.CHECK_STOCK,payload:e})}},u=function(){return function(e){e({type:r.M.EMPTY_BASKET})}}},7621:function(e,n,t){t.d(n,{Z:function(){return x}});var r=t(7462),s=t(3366),i=t(2791),o=t(8182),c=t(767),u=t(7630),a=t(1046),l=t(703),d=t(5159);function f(e){return(0,d.Z)("MuiCard",e)}(0,t(208).Z)("MuiCard",["root"]);var p=t(184),h=["className","raised"],m=(0,u.ZP)(l.Z,{name:"MuiCard",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(){return{overflow:"hidden"}})),x=i.forwardRef((function(e,n){var t=(0,a.Z)({props:e,name:"MuiCard"}),i=t.className,u=t.raised,l=void 0!==u&&u,d=(0,s.Z)(t,h),x=(0,r.Z)({},t,{raised:l}),y=function(e){var n=e.classes;return(0,c.Z)({root:["root"]},f,n)}(x);return(0,p.jsx)(m,(0,r.Z)({className:(0,o.Z)(y.root,i),elevation:l?8:void 0,ref:n,ownerState:x},d))}))}}]);
//# sourceMappingURL=813.76d8ca48.chunk.js.map